<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Be My Valentine?</title>

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<style>
:root {
    --pink: #ff4d6d;
    --light-pink: #fff0f3;
    --dark-red: #800f2f;
}

body {
    margin: 0;
    height: 100vh;
    width: 100vw;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--light-pink);
    font-family: 'Segoe UI', Arial, sans-serif;
    overflow: hidden;
    position: relative;
}

.sticker {
    position: absolute;
    width: clamp(60px, 15vw, 110px); /* Responsive sizing */
    height: auto;
    opacity: 0.9;
    z-index: 1;
    user-select: none;
    pointer-events: none;
    filter: drop-shadow(3px 3px 5px rgba(0,0,0,0.1));
    visibility: hidden;
}

.card {
    background: white;
    padding: clamp(20px, 5vw, 50px);
    border-radius: 30px;
    width: min(90%, 400px);
    text-align: center;
    border: 6px solid white;
    box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    z-index: 10;
    position: relative;
}

h1 { 
    color: var(--dark-red); 
    margin-bottom: 20px; 
    font-size: clamp(1.5rem, 6vw, 2.2rem);
}

.button-box {
    position: relative;
    width: 100%;
    height: 100px;
    margin-top: 20px;
}

.btn {
    padding: 12px 28px;
    font-size: clamp(1rem, 4vw, 1.2rem);
    font-weight: bold;
    border: none;
    border-radius: 12px;
    cursor: pointer;
    position: absolute;
    top: 50%;
    transform: translate(-50%, -50%);
}

#yesBtn { 
    background: var(--pink); 
    color: white; 
    left: 30%; 
    z-index: 20; 
}

#noBtn { 
    background: #f0f0f0; 
    color: #666; 
    left: 70%; 
    transition: all 0.2s ease; 
    z-index: 19;
}

.celebrate { animation: bounce 0.6s ease infinite alternate; }
@keyframes bounce { from { transform: scale(1); } to { transform: scale(1.03); } }
</style>
</head>

<body>

<div id="sticker-container"></div>

<div class="card" id="mainCard">
    <h1>Will you be my Valentine? ü•∫</h1>
    <div class="button-box" id="arena">
        <button class="btn" id="yesBtn">Yes!</button>
        <button class="btn" id="noBtn">No</button>
    </div>
</div>

<script>
const card = document.getElementById('mainCard');
const noBtn = document.getElementById('noBtn');
const yesBtn = document.getElementById('yesBtn');
const arena = document.getElementById('arena');
const stickerContainer = document.getElementById('sticker-container');

async function loadStickers() {
    const cardRect = card.getBoundingClientRect();
    const placedRects = [cardRect]; // Start with the card to avoid it
    const maxStickers = 15; 
    const folder = 'stickers/';
    const ext = '.webp';
    
    // Responsive grid
    const isMobile = window.innerWidth < 600;
    const cols = isMobile ? 3 : 5;
    const rows = isMobile ? 4 : 3;
    const cellW = window.innerWidth / cols;
    const cellH = window.innerHeight / rows;

    for (let i = 1; i <= maxStickers; i++) {
        const tempImg = new Image();
        tempImg.src = `${folder}${i}${ext}`;
        
        tempImg.onload = function() {
            const s = document.createElement('img');
            s.src = tempImg.src;
            s.className = 'sticker';
            stickerContainer.appendChild(s);

            const sWidth = s.offsetWidth || 100;
            const sHeight = s.offsetHeight || 100;

            let col = (i - 1) % cols;
            let row = Math.floor((i - 1) / cols);
            let attempts = 0;
            let placed = false;

            while (!placed && attempts < 20) {
                let x = (col * cellW) + Math.random() * (cellW - sWidth);
                let y = (row * cellH) + Math.random() * (cellH - sHeight);
                
                // Contain within screen
                x = Math.max(10, Math.min(x, window.innerWidth - sWidth - 10));
                y = Math.max(10, Math.min(y, window.innerHeight - sHeight - 10));

                const newRect = { left: x, top: y, right: x + sWidth, bottom: y + sHeight };

                // Strict Overlap Check
                const overlaps = placedRects.some(r => {
                    return !(newRect.right < r.left - 10 || 
                             newRect.left > r.right + 10 || 
                             newRect.bottom < r.top - 10 || 
                             newRect.top > r.bottom + 10);
                });

                if (!overlaps) {
                    s.style.left = `${x}px`;
                    s.style.top = `${y}px`;
                    s.style.transform = `rotate(${Math.random() * 30 - 15}deg)`;
                    s.style.visibility = 'visible';
                    placedRects.push(newRect);
                    placed = true;
                }
                attempts++;
            }
        };
    }
}

window.addEventListener('load', loadStickers);

noBtn.addEventListener('mouseover', moveNo);
noBtn.addEventListener('touchstart', (e) => { e.preventDefault(); moveNo(); });

function moveNo() {
    const arenaRect = arena.getBoundingClientRect();
    noBtn.style.transform = "none"; 
    const maxX = arenaRect.width - noBtn.offsetWidth;
    const maxY = arenaRect.height - noBtn.offsetHeight;
    let x = Math.random() * maxX;
    let y = Math.random() * maxY;
    
    // Avoid the Yes button center
    if (Math.abs(x - arenaRect.width * 0.3) < 60) x = x < arenaRect.width * 0.3 ? 5 : maxX - 5;
    
    noBtn.style.left = `${x}px`;
    noBtn.style.top = `${y}px`;
}

yesBtn.addEventListener('click', () => {
    confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 }, zIndex: 100 });
    card.classList.add('celebrate');
    setTimeout(() => {
        card.innerHTML = `<h1 style="font-size: clamp(2rem, 8vw, 3rem);">YAY! ‚ù§Ô∏è</h1><p>You made my day!</p><div style="font-size:4rem; margin-top:10px;">ü•∞</div>`;
    }, 300);
});
</script>
</body>
</html>